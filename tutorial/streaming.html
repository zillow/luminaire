<!DOCTYPE html> <html lang=en > <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.19: https://docutils.sourceforge.io/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&family=Nunito+Sans:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel=stylesheet > <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#3f51b5"> <script src="../_static/javascripts/modernizr.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119269936-5"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-119269936-5'); </script> <title>Anomaly Detection for Streaming data &#8212; Luminaire</title> <link rel=stylesheet  href="../_static/global.css"> <link rel=stylesheet  href="../_static/colors.css"> <link rel=stylesheet  type="text/css" href="../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../_static/material.css" /> <script data-url_root="../" id=documentation_options  src="../_static/documentation_options.js"></script> <script src="../_static/jquery.js"></script> <script src="../_static/underscore.js"></script> <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script> <script src="../_static/doctools.js"></script> <script src="../_static/sphinx_highlight.js"></script> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <link rel=next  title="Luminaire Outlier Detection Models: Structural Modeling" href="../api_reference/batch_models.html" /> <link rel=prev  title="Outlier Detection" href=outlier_batch.html  /> <body dir=ltr data-md-color-primary=custom data-md-color-accent=custom> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#tutorial/streaming" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title=Luminaire  class="md-header-nav__button md-logo"> <img src="../_static/luminaire_logo.svg" height=26  alt="Luminaire logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >Luminaire</span> <span class=md-header-nav__topic > Anomaly Detection for Streaming data </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/zillow/luminaire/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > Fork me on Github </div> </a> </div> </div> <script src="../_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../"versions.json"", target_loc = "../../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title=Luminaire  class="md-nav__button md-logo"> <img src="../_static/luminaire_logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../index.html" title=Luminaire >Luminaire</a> </label> <div class=md-nav__source > <a href="https://github.com/zillow/luminaire/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > Fork me on Github </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Tutorial</span></span> <li class=md-nav__item > <a href=dataprofiling.html  class=md-nav__link >Data Profiling</a> <li class=md-nav__item > <a href=optimization.html  class=md-nav__link >Configuration Optimization</a> <li class=md-nav__item > <a href=outlier_batch.html  class=md-nav__link >Outlier Detection</a> <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Anomaly Detection for Streaming data </label> <a href="#" class="md-nav__link md-nav__link--active">Anomaly Detection for Streaming data</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#tutorial-streaming--page-root" class=md-nav__link >Anomaly Detection for Streaming data</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#fully-automated-anomaly-detection-using-time-windows" class=md-nav__link >Fully Automated Anomaly Detection using Time-windows</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#reusing-past-trained-model" class=md-nav__link >Reusing Past Trained Model</a> </ul> </nav> <li class=md-nav__item ><a href="#anomaly-detection-using-time-windows-manual-configuration" class=md-nav__link >Anomaly Detection using Time-windows: Manual Configuration</a> </ul> </nav> </ul> </nav> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >API Reference</span></span> <li class=md-nav__item > <a href="../api_reference/batch_models.html" class=md-nav__link >Luminaire Outlier Detection Models: Structural Modeling</a> <li class=md-nav__item > <a href="../api_reference/batch_models.html#module-luminaire.model.model_utils" class=md-nav__link >Luminaire Outlier Detection Models: Factoring holidays as exogenous</a> <li class=md-nav__item > <a href="../api_reference/batch_models.html#module-luminaire.model.lad_filtering" class=md-nav__link >Luminaire Outlier Detection Models: Kalman Filter</a> <li class=md-nav__item > <a href="../api_reference/exploration.html" class=md-nav__link >Data Exploration and Profiling</a> <li class=md-nav__item > <a href="../api_reference/optimization.html" class=md-nav__link >Luminaire Configuration Optimization</a> <li class=md-nav__item > <a href="../api_reference/streaming.html" class=md-nav__link >Luminaire Streaming Anomaly Detection Models: Window Density Model</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#tutorial-streaming--page-root" class=md-nav__link >Anomaly Detection for Streaming data</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#fully-automated-anomaly-detection-using-time-windows" class=md-nav__link >Fully Automated Anomaly Detection using Time-windows</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#reusing-past-trained-model" class=md-nav__link >Reusing Past Trained Model</a> </ul> </nav> <li class=md-nav__item ><a href="#anomaly-detection-using-time-windows-manual-configuration" class=md-nav__link >Anomaly Detection using Time-windows: Manual Configuration</a> </ul> </nav> </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <section id=anomaly-detection-for-streaming-data > <h1 id=tutorial-streaming--page-root >Anomaly Detection for Streaming data<a class=headerlink  href="#tutorial-streaming--page-root" title="Permalink to this heading">¶</a></h1> <p>Luminaire <em>WindowDensityModel</em> implements the idea of monitoring data over comparable windows instead of tracking individual data points as outliers. This is a useful approach for tracking anomalies over high frequency data, which tends to show a higher level of noise. Hence, tracking anomalies over streaming data essesntially means tracking sustained fluctuations.</p> <a class="reference internal image-reference" href="../_images/windows.png"><img alt="../_images/windows.png" src="../_images/windows.png" style="width: 704.0px; height: 291.2px;"/></a> <p>Although <em>WindowDensityModel</em> is designed to track anomalies over streaming data, it can be used to track anomalies even for low frequency time series. This detection type is suggested for up to hourly data frequency.</p> <p>This window based anomaly detection feature in Luminaire operates fully automatically where the underlying model detects the frequency that the data has been observed, the optimal size of the window (using the periodic signals in the data) and the optimal detection method given some identified characteristics from the input time series. Moreover, user also has the ability to overwright the configuration for custom use cases.</p> <section id=fully-automated-anomaly-detection-using-time-windows > <h2 id=fully-automated-anomaly-detection-using-time-windows >Fully Automated Anomaly Detection using Time-windows<a class=headerlink  href="#fully-automated-anomaly-detection-using-time-windows" title="Permalink to this heading">¶</a></h2> <p>Luminaire provides a fully automated anomaly detection method that tracks time series abnormalities over time-windows. Luminaire is capable of selecting the best possible setting by studying different characteristics of the input time series. Although, compared to the Luminaire outlier detection module, the window based anomaly detection does not require running any separate configuration optimization to obtain the best hyperparameters. Rather, the automation process is embedded withing the data exploration and the training process.</p> <p>Similar to the outlier detection module, Luminaire Window Density Model comes with a streaming data profiling module to extract different characteristics about the high-frequency time series.</p> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=kn >from</span> <span class=nn >luminaire.model.window_density</span> <span class=kn >import</span> <span class=n >WindowDensityHyperParams</span><span class=p >,</span> <span class=n >WindowDensityModel</span>
<span class=gp >&gt;&gt;&gt; </span><span class=kn >from</span> <span class=nn >luminaire.exploration.data_exploration</span> <span class=kn >import</span> <span class=n >DataExploration</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >data</span><span class=p >)</span>
<span class=go >                        raw</span>
<span class=go >index</span>
<span class=go >2020-06-04 00:00:00  227798</span>
<span class=go >2020-06-04 00:10:00  224593</span>
<span class=go >2020-06-04 00:20:00  229400</span>
<span class=go >2020-06-04 00:30:00  217813</span>
<span class=go >2020-06-04 00:40:00  217862</span>
<span class=gp >... </span>                    <span class=o >...</span>
<span class=go >2020-07-02 23:20:00  221226</span>
<span class=go >2020-07-02 23:30:00  218762</span>
<span class=go >2020-07-02 23:40:00  225726</span>
<span class=go >2020-07-02 23:50:00  220783</span>
<span class=go >2020-07-03 00:00:00  260981</span>
</pre></div> </div> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=n >config</span> <span class=o >=</span> <span class=n >WindowDensityHyperParams</span><span class=p >()</span><span class=o >.</span><span class=n >params</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >de_obj</span> <span class=o >=</span> <span class=n >DataExploration</span><span class=p >(</span><span class=o >**</span><span class=n >config</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >data</span><span class=p >,</span> <span class=n >pre_prc</span> <span class=o >=</span> <span class=n >de_obj</span><span class=o >.</span><span class=n >stream_profile</span><span class=p >(</span><span class=n >df</span><span class=o >=</span><span class=n >data</span><span class=p >)</span>
<span class=go >print(data, pre_prc)</span>
<span class=go >                        raw  interpolated</span>
<span class=go >2020-06-04 00:10:00  224593      224593.0</span>
<span class=go >2020-06-04 00:20:00  229400      229400.0</span>
<span class=go >2020-06-04 00:30:00  217813      217813.0</span>
<span class=go >2020-06-04 00:40:00  217862      217862.0</span>
<span class=go >2020-06-04 00:50:00  226861      226861.0</span>
<span class=gp >... </span>                    <span class=o >...</span>           <span class=o >...</span>
<span class=go >2020-07-02 23:20:00  221226      221226.0</span>
<span class=go >2020-07-02 23:30:00  218762      218762.0</span>
<span class=go >2020-07-02 23:40:00  225726      225726.0</span>
<span class=go >2020-07-02 23:50:00  220783      220783.0</span>
<span class=go >2020-07-03 00:00:00  260981      260981.0</span>
<span class=go >[4176 rows x 2 columns]</span>
<span class=go >{'success': True, 'freq': '0 days 00:10:00', 'window_length': 144, 'min_window_length': 10, 'max_window_length': 100000}</span>
</pre></div> </div> <p>Luminaire <em>stream_profile</em> performs missing data imputation if necessary, extracts the frequency information and obtains the optimal size of the window to be monitored (if not specified by the user). All the information obtained by the profiler can be used to update the configuration for the actual training process.</p> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=n >config</span><span class=o >.</span><span class=n >update</span><span class=p >(</span><span class=n >pre_prc</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >wdm_obj</span> <span class=o >=</span> <span class=n >WindowDensityModel</span><span class=p >(</span><span class=n >hyper_params</span><span class=o >=</span><span class=n >config</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >success</span><span class=p >,</span> <span class=n >training_end</span><span class=p >,</span> <span class=n >model</span> <span class=o >=</span> <span class=n >wdm_obj</span><span class=o >.</span><span class=n >train</span><span class=p >(</span><span class=n >data</span><span class=o >=</span><span class=n >data</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >success</span><span class=p >,</span> <span class=n >training_end</span><span class=p >,</span> <span class=n >model</span><span class=p >)</span>
<span class=go >True 2020-07-03 00:00:00 &lt;luminaire.model.window_density.WindowDensityModel object at 0x7fb6fab80b00&gt;</span>
</pre></div> </div> <p>The training process generates the success flag, the model timestamp and the actual trained model. The trained model here is a collection of several sub-models that can be used to score any equal length time segment of the day and does not depend on the specific patterns based on the selected time window. In order to score a new window innovation given the trained model object, we have to provide a equal sized time window. Moreover, Luminaire allows the user to perform basic processing (imputing missing index etc.) of the scoring window in order to get the data ready for scoring.</p> <a class="reference internal image-reference" href="../_images/window_train_score_auto.png"><img alt="../_images/window_train_score_auto.png" src="../_images/window_train_score_auto.png" style="width: 640.0px; height: 480.0px;"/></a> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >scoring_data</span><span class=p >)</span>
<span class=go >                        raw</span>
<span class=go >index</span>
<span class=go >2020-07-03 00:00:00  260981</span>
<span class=go >2020-07-03 00:10:00  274249</span>
<span class=go >2020-07-03 00:20:00  293194</span>
<span class=go >2020-07-03 00:30:00  272722</span>
<span class=go >2020-07-03 00:40:00  276930</span>
<span class=gp >... </span>                    <span class=o >...</span>
<span class=go >2020-07-03 23:10:00  287773</span>
<span class=go >2020-07-03 23:20:00  255438</span>
<span class=go >2020-07-03 23:30:00  277127</span>
<span class=go >2020-07-03 23:40:00  266263</span>
<span class=go >2020-07-03 23:50:00  275432</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >freq</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >_params</span><span class=p >[</span><span class=s1 >'freq'</span><span class=p >]</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >de_obj</span> <span class=o >=</span> <span class=n >DataExploration</span><span class=p >(</span><span class=n >freq</span><span class=o >=</span><span class=n >freq</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >processed_data</span><span class=p >,</span> <span class=n >pre_prc</span> <span class=o >=</span> <span class=n >de_obj</span><span class=o >.</span><span class=n >stream_profile</span><span class=p >(</span><span class=n >df</span><span class=o >=</span><span class=n >scoring_data</span><span class=p >,</span> <span class=n >impute_only</span><span class=o >=</span><span class=kc >True</span><span class=p >,</span> <span class=n >impute_zero</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
</pre></div> </div> <p>The processed data can be used to score as:</p> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=n >score</span><span class=p >,</span> <span class=n >scored_window</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >score</span><span class=p >(</span><span class=n >processed_data</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >score</span><span class=p >)</span>
<span class=go >{'Success': True, 'ConfLevel': 99.9, 'IsAnomaly': True, 'AnomalyProbability': 1.0}</span>
</pre></div> </div> <p>User can also score rolling (or overlapping windows) windows instead of sequential windows for more frequent anomaly detection use cases.</p> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >scoring_data</span><span class=p >)</span>
<span class=go >                        raw</span>
<span class=go >index</span>
<span class=go >2020-07-02 12:10:00  203836</span>
<span class=go >2020-07-02 12:20:00  209813</span>
<span class=go >2020-07-02 12:30:00  206271</span>
<span class=go >2020-07-02 12:40:00  209135</span>
<span class=go >2020-07-02 12:50:00  207085</span>
<span class=gp >... </span>                    <span class=o >...</span>
<span class=go >2020-07-03 11:20:00  255009</span>
<span class=go >2020-07-03 11:30:00  260246</span>
<span class=go >2020-07-03 11:40:00  248541</span>
<span class=go >2020-07-03 11:50:00  246094</span>
<span class=go >2020-07-03 12:00:00  252223</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >freq</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >_params</span><span class=p >[</span><span class=s1 >'freq'</span><span class=p >]</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >de_obj</span> <span class=o >=</span> <span class=n >DataExploration</span><span class=p >(</span><span class=n >freq</span><span class=o >=</span><span class=n >freq</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >processed_data</span><span class=p >,</span> <span class=n >pre_prc</span> <span class=o >=</span> <span class=n >de_obj</span><span class=o >.</span><span class=n >stream_profile</span><span class=p >(</span><span class=n >df</span><span class=o >=</span><span class=n >scoring_data</span><span class=p >,</span> <span class=n >impute_only</span><span class=o >=</span><span class=kc >True</span><span class=p >,</span> <span class=n >impute_zero</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >score</span><span class=p >,</span> <span class=n >scored_window</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >score</span><span class=p >(</span><span class=n >processed_data</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >score</span><span class=p >)</span>
<span class=go >'Success': True, 'ConfLevel': 99.9, 'IsAnomaly': True, 'AnomalyProbability': 0.9999867236}</span>
</pre></div> </div> <section id=reusing-past-trained-model > <h3 id=reusing-past-trained-model >Reusing Past Trained Model<a class=headerlink  href="#reusing-past-trained-model" title="Permalink to this heading">¶</a></h3> <p>Luminaire Window Density model also comes with the capability of ingesting previously trained model in the future model trainings. This can be part of a sequential process that always passes the last trained model in the next training. This ensures richer data accumulation to have more reliable scores, specially when the training history is limited to a fixed length rolling window. This way, the model is able to keep larger history as a metadata even though the actual training history is limited.</p> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=n >past_model</span> <span class=o >=</span> <span class=o >&lt;</span><span class=n >luminaire</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >window_density</span><span class=o >.</span><span class=n >WindowDensityModel</span> <span class=nb >object</span> <span class=n >at</span> <span class=mh >0x7fb6fab80b00</span><span class=o >&gt;</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >new_training_data</span><span class=p >)</span>
<span class=go >                        raw</span>
<span class=go >index</span>
<span class=go >2020-06-04 00:00:00  227798</span>
<span class=go >2020-06-04 00:10:00  224593</span>
<span class=go >2020-06-04 00:20:00  229400</span>
<span class=go >2020-06-04 00:30:00  217813</span>
<span class=go >2020-06-04 00:40:00  217862</span>
<span class=gp >... </span>                    <span class=o >...</span>
<span class=go >2020-07-03 23:10:00  287773</span>
<span class=go >2020-07-03 23:20:00  255438</span>
<span class=go >2020-07-03 23:30:00  277127</span>
<span class=go >2020-07-03 23:40:00  266263</span>
<span class=go >2020-07-03 23:50:00  275432</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >success</span><span class=p >,</span> <span class=n >training_end</span><span class=p >,</span> <span class=n >model</span> <span class=o >=</span> <span class=n >wdm_obj</span><span class=o >.</span><span class=n >train</span><span class=p >(</span><span class=n >data</span><span class=o >=</span><span class=n >new_training_data</span><span class=p >,</span> <span class=n >past_model</span><span class=o >=</span><span class=n >past_model</span><span class=p >)</span>
</pre></div> </div> </section> </section> <section id=anomaly-detection-using-time-windows-manual-configuration > <h2 id=anomaly-detection-using-time-windows-manual-configuration >Anomaly Detection using Time-windows: Manual Configuration<a class=headerlink  href="#anomaly-detection-using-time-windows-manual-configuration" title="Permalink to this heading">¶</a></h2> <p>There are several options in the <em>WindowDensityHyperParams</em> class that can be manually configured. User can select different option starting from the desired window size, whether all previous windows should be used to identify anomalies or the last window only, the detection method and how to manage nonstationarity and periodicity present in the data and so on. Please refer to the API reference for <a class="reference external" href="https://zillow.github.io/luminaire/api_reference/streaming.html">Streaming Anomaly Detection Models</a>.</p> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=kn >from</span> <span class=nn >luminaire.model.window_density</span> <span class=kn >import</span> <span class=n >WindowDensityHyperParams</span><span class=p >,</span> <span class=n >WindowDensityModel</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >data</span><span class=p >)</span>
<span class=go >                        raw</span>
<span class=go >index</span>
<span class=go >2020-06-04 00:00:00  227798</span>
<span class=go >2020-06-04 00:10:00  224593</span>
<span class=go >2020-06-04 00:20:00  229400</span>
<span class=go >2020-06-04 00:30:00  217813</span>
<span class=go >2020-06-04 00:40:00  217862</span>
<span class=gp >... </span>                    <span class=o >...</span>
<span class=go >2020-07-02 23:20:00  221226</span>
<span class=go >2020-07-02 23:30:00  218762</span>
<span class=go >2020-07-02 23:40:00  225726</span>
<span class=go >2020-07-02 23:50:00  220783</span>
<span class=go >2020-07-03 00:00:00  218315</span>
<span class=go >&gt;&gt;&gt;config = WindowDensityHyperParams(freq='10T',</span>
<span class=go >                                     detection_method='kldiv',</span>
<span class=go >                                     baseline_type="last_window",</span>
<span class=go >                                     window_length=6*6,</span>
<span class=go >                                     detrend_method='modeling'</span>
<span class=go >                                     ).params</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >de_obj</span> <span class=o >=</span> <span class=n >DataExploration</span><span class=p >(</span><span class=o >**</span><span class=n >config</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >data</span><span class=p >,</span> <span class=n >pre_prc</span> <span class=o >=</span> <span class=n >de_obj</span><span class=o >.</span><span class=n >stream_profile</span><span class=p >(</span><span class=n >df</span><span class=o >=</span><span class=n >data</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >data</span><span class=p >,</span> <span class=n >pre_prc</span><span class=p >)</span>
<span class=go >                        raw  interpolated</span>
<span class=go >2020-06-05 00:10:00  227504      227504.0</span>
<span class=go >2020-06-05 00:20:00  225664      225664.0</span>
<span class=go >2020-06-05 00:30:00  227586      227586.0</span>
<span class=go >2020-06-05 00:40:00  223805      223805.0</span>
<span class=go >2020-06-05 00:50:00  222679      222679.0</span>
<span class=gp >... </span>                    <span class=o >...</span>           <span class=o >...</span>
<span class=go >2020-07-02 23:20:00  221226      221226.0</span>
<span class=go >2020-07-02 23:30:00  218762      218762.0</span>
<span class=go >2020-07-02 23:40:00  225726      225726.0</span>
<span class=go >2020-07-02 23:50:00  220783      220783.0</span>
<span class=go >2020-07-03 00:00:00  218315      218315.0</span>
<span class=go >[4032 rows x 2 columns]</span>
<span class=go >{'success': True, 'freq': '10T', 'window_length': 36, 'min_window_length': 10, 'max_window_length': 100000}</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >config</span><span class=o >.</span><span class=n >update</span><span class=p >(</span><span class=n >pre_prc</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >wdm_obj</span> <span class=o >=</span> <span class=n >WindowDensityModel</span><span class=p >(</span><span class=n >hyper_params</span><span class=o >=</span><span class=n >config</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >success</span><span class=p >,</span> <span class=n >training_end</span><span class=p >,</span> <span class=n >model</span> <span class=o >=</span> <span class=n >wdm_obj</span><span class=o >.</span><span class=n >train</span><span class=p >(</span><span class=n >data</span><span class=o >=</span><span class=n >data</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >success</span><span class=p >,</span> <span class=n >training_end</span><span class=p >,</span> <span class=n >model</span><span class=p >)</span>
<span class=go >True 2020-07-03 00:00:00 &lt;luminaire.model.window_density.WindowDensityModel object at 0x7ff33ef74550&gt;</span>
</pre></div> </div> <p>The trained model object can be used to score the data of a similar window size.</p> <a class="reference internal image-reference" href="../_images/window_train_score_manual.png"><img alt="../_images/window_train_score_manual.png" src="../_images/window_train_score_manual.png" style="width: 640.0px; height: 480.0px;"/></a> <div class="doctest highlight-default notranslate"><div class=highlight ><pre><span></span><span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >data</span><span class=p >)</span>
<span class=go >                        raw</span>
<span class=go >index</span>
<span class=go >2020-07-03 06:10:00  222985</span>
<span class=go >2020-07-03 06:20:00  210951</span>
<span class=go >2020-07-03 06:30:00  210094</span>
<span class=go >2020-07-03 06:40:00  215166</span>
<span class=go >2020-07-03 06:50:00  212968</span>
<span class=gp >... </span>                    <span class=o >...</span>
<span class=go >2020-07-03 11:20:00  209008</span>
<span class=go >2020-07-03 11:30:00  211170</span>
<span class=go >2020-07-03 11:40:00  203302</span>
<span class=go >2020-07-03 11:50:00  204498</span>
<span class=go >2020-07-03 12:00:00  203234</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >freq</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >_params</span><span class=p >[</span><span class=s1 >'freq'</span><span class=p >]</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >de_obj</span> <span class=o >=</span> <span class=n >DataExploration</span><span class=p >(</span><span class=n >freq</span><span class=o >=</span><span class=n >freq</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >processed_data</span><span class=p >,</span> <span class=n >pre_prc</span> <span class=o >=</span> <span class=n >de_obj</span><span class=o >.</span><span class=n >stream_profile</span><span class=p >(</span><span class=n >df</span><span class=o >=</span><span class=n >data</span><span class=p >,</span> <span class=n >impute_only</span><span class=o >=</span><span class=kc >True</span><span class=p >,</span> <span class=n >impute_zero</span><span class=o >=</span><span class=kc >True</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=n >score</span><span class=p >,</span> <span class=n >scored_window</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >score</span><span class=p >(</span><span class=n >processed_data</span><span class=p >)</span>
<span class=gp >&gt;&gt;&gt; </span><span class=nb >print</span><span class=p >(</span><span class=n >score</span><span class=p >)</span>
<span class=go >{'Success': True, 'ConfLevel': 99.9, 'IsAnomaly': False, 'AnomalyProbability': 0.330817121756509}</span>
</pre></div> </div> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href=outlier_batch.html  title="Outlier Detection" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Previous </span> Outlier Detection </span> </div> </a> <a href="../api_reference/batch_models.html" title="Luminaire Outlier Detection Models: Structural Modeling" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next > <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Next </span> Luminaire Outlier Detection Models: Structural Modeling </span> </div> <div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2020 Zillow, Inc.. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.3.0. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>